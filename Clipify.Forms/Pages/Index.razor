@page "/"

@inject IMessageService MsgService
@inject INotificationService NotiService

<div class="py-8 px-4 border-2 border-gray-200 border-dashed rounded-lg dark:border-gray-700">
    <!-- å¤´éƒ¨åŒºåŸŸ -->
    <div class="flex flex-col md:flex-row items-center justify-between gap-4 mb-8">
        <div class="flex items-center gap-4">
            <img src="images/ClipifyLogo.png" alt="Clipify Logo" class="w-40 h-auto">
            <div class="text-left hidden md:block">
                <div class="flex gap-2 items-center">
                    <h1 class="text-2xl font-bold text-blue-600 dark:text-blue-400">Clipify</h1>
                    <h2 class="text-xl font-semibold text-gray-800 dark:text-white mb-2">è§†é¢‘ç¼–è¾‘ï¼Œä»æœªå¦‚æ­¤ç®€å•</h2>
                </div>
                <!-- ä»‹ç»åŒºåŸŸ -->
                <div class="">
                    @* <p class="text-gray-600 dark:text-gray-300">ç®€å•æµç•…çš„è§†é¢‘ç¼–è¾‘å·¥å…·</p> *@
                    <p class="text-gray-600 dark:text-gray-300 mb-2">Clipify æ˜¯ä¸€ä¸ªåŸºäº Blazor Hybrid æŠ€æœ¯å¼€å‘çš„ç®€å•æµç•…çš„è§†é¢‘ç¼–è¾‘å·¥å…·ã€‚</p>
                    <p class="text-gray-600 dark:text-gray-300">ä¸“ä¸ºæä¾›å¿«é€Ÿã€è½»æ¾çš„è§†é¢‘å‰ªè¾‘ä½“éªŒè€Œè®¾è®¡ã€‚</p>
                </div>
            </div>
        </div>
        <div class="flex flex-col space-y-2">
            @foreach (var link in Links) {
            <a href="@link.Href" class="inline-flex items-center justify-start w-36 py-2 px-4 text-base font-medium text-gray-500 rounded-lg bg-gray-50 hover:text-blue-600 hover:bg-gray-100 transition-colors dark:text-gray-400 dark:bg-gray-800 dark:hover:bg-gray-700 dark:hover:text-blue-400">
                <i class="@link.IconClass text-xl me-3 w-5 text-center"></i>
                <span>@link.Name</span>
            </a>
            }
        </div>
    </div>

    

    <!-- å¿«é€Ÿå¼€å§‹åŒºåŸŸ -->
    <div class="bg-blue-50 dark:bg-gray-800 rounded-lg p-6 mb-8">
        <h3 class="text-lg font-medium text-blue-700 dark:text-blue-400 mb-4">ğŸš€ å¿«é€Ÿå¼€å§‹</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <a href="@RouterMap.VideoSplit" class="flex items-center p-4 bg-white dark:bg-gray-700 rounded-lg shadow-sm hover:shadow-md transition-shadow">
                <div class="bg-blue-100 dark:bg-blue-900 p-3 rounded-full mr-4">
                    <i class="fa-solid fa-scissors text-blue-600 dark:text-blue-400"></i>
                </div>
                <div>
                    <h4 class="font-medium text-gray-900 dark:text-white">è§†é¢‘åˆ†å‰²</h4>
                    <p class="text-sm text-gray-600 dark:text-gray-300">å°†è§†é¢‘åˆ†å‰²æˆå¤šä¸ªç‰‡æ®µ</p>
                </div>
            </a>
            <a href="@RouterMap.ExtractAudio" class="flex items-center p-4 bg-white dark:bg-gray-700 rounded-lg shadow-sm hover:shadow-md transition-shadow">
                <div class="bg-blue-100 dark:bg-blue-900 p-3 rounded-full mr-4">
                    <i class="fa-solid fa-music text-blue-600 dark:text-blue-400"></i>
                </div>
                <div>
                    <h4 class="font-medium text-gray-900 dark:text-white">éŸ³é¢‘æå–</h4>
                    <p class="text-sm text-gray-600 dark:text-gray-300">ä»è§†é¢‘ä¸­æå–éŸ³é¢‘</p>
                </div>
            </a>
            <button @onclick="OpenFileDialog" class="flex items-center p-4 bg-gradient-to-r from-blue-500 to-blue-600 dark:from-blue-600 dark:to-blue-700 rounded-lg shadow-sm hover:shadow-md transition-shadow">
                <div class="bg-white dark:bg-gray-800 p-3 rounded-full mr-4">
                    <i class="fa-solid fa-file-video text-blue-600 dark:text-blue-400"></i>
                </div>
                <div class="text-left">
                    <h4 class="font-medium text-white">æ‰“å¼€è§†é¢‘æ–‡ä»¶</h4>
                    <p class="text-sm text-blue-100">å¼€å§‹ä½ çš„åˆ›ä½œä¹‹æ—…</p>
                </div>
            </button>
        </div>
    </div>

    <!-- åŠŸèƒ½åˆ†ç±»åŒºåŸŸ -->
    <div class="mb-2">
        <h3 class="text-lg font-medium text-gray-800 dark:text-white mb-4 flex items-center">
            <i class="fa-solid fa-th-large mr-2 text-blue-600 dark:text-blue-400"></i>
            åŠŸèƒ½ä¸­å¿ƒ
        </h3>
        
        <!-- åˆ†ç±»é€‰é¡¹å¡ -->
        <div class="mb-6">
            <div class="flex flex-wrap gap-2 mb-4">
                @foreach (var category in FeatureCategories)
                {
                    <button @onclick="() => SelectCategory(category.Id)" 
                            class="@(selectedCategory == category.Id ? "bg-blue-600 text-white" : "bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300") 
                                   py-2 px-4 rounded-full text-sm font-medium transition-colors">
                        <i class="@category.IconClass mr-1"></i>
                        @category.Name
                    </button>
                }
            </div>
        </div>

        <!-- åŠŸèƒ½å¡ç‰‡ç½‘æ ¼ -->
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
            @foreach (var feature in GetFilteredFeatures())
            {
                if (string.IsNullOrWhiteSpace(feature.Href))
                {
                    <Tooltip Placement="Placement.Top" Title="@feature.Desc" ArrowPointAtCenter="true">
                        <a href="#" @onclick="() => FeatureInDev(feature)"
                           class="flex flex-col items-center p-4 bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700 relative">
                            <div class="absolute top-2 right-2">
                                <span class="inline-flex items-center justify-center px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300">
                                    å¼€å‘ä¸­
                                </span>
                            </div>
                            <i class="@feature.IconClass text-4xl mb-3 text-gray-600 dark:text-gray-300"></i>
                            <h5 class="text-base font-medium text-gray-900 dark:text-white text-center">@feature.Name</h5>
                        </a>
                    </Tooltip>
                }
                else
                {
                    <Tooltip Placement="Placement.Top" Title="@feature.Desc" ArrowPointAtCenter="true">
                        <a href="@feature.Href"
                           class="flex flex-col items-center p-4 bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md hover:border-blue-300 transition-all dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700 dark:hover:border-blue-600">
                            <i class="@feature.IconClass text-4xl mb-3 text-blue-600 dark:text-blue-400"></i>
                            <h5 class="text-base font-medium text-gray-900 dark:text-white text-center">@feature.Name</h5>
                        </a>
                    </Tooltip>
                }
            }
        </div>
    </div>

    <!-- åº•éƒ¨åŒºåŸŸ -->
    <div class="mt-8 pt-4 border-t border-gray-200 dark:border-gray-700 text-center text-gray-500 dark:text-gray-400 text-sm">
        <p>Clipify - è®©è§†é¢‘ç¼–è¾‘æ›´ç®€å• Â© @DateTime.Now.Year</p>
    </div>
</div>

@code{
    private string selectedCategory = "all";

    public class ActionLink {
        public string IconClass { get; set; }
        public string Name { get; set; }
        public string Href { get; set; }
    }

    public class FeatureCard {
        public string IconClass { get; set; }
        public string Name { get; set; }
        public string? Href { get; set; }
        public string? Desc { get; set; }
        public string Category { get; set; } = "other";
    }

    public class CategoryItem {
        public string Id { get; set; }
        public string Name { get; set; }
        public string IconClass { get; set; }
    }

    public List<CategoryItem> FeatureCategories { get; set; } = new List<CategoryItem> {
        new CategoryItem { Id = "all", Name = "å…¨éƒ¨åŠŸèƒ½", IconClass = "fa-solid fa-border-all" },
        new CategoryItem { Id = "basic", Name = "åŸºç¡€ç¼–è¾‘", IconClass = "fa-solid fa-cut" },
        new CategoryItem { Id = "audio", Name = "éŸ³é¢‘å¤„ç†", IconClass = "fa-solid fa-volume-up" },
        new CategoryItem { Id = "enhance", Name = "è§†é¢‘å¢å¼º", IconClass = "fa-solid fa-magic" },
        new CategoryItem { Id = "subtitle", Name = "å­—å¹•å·¥å…·", IconClass = "fa-solid fa-closed-captioning" },
        new CategoryItem { Id = "other", Name = "å…¶ä»–å·¥å…·", IconClass = "fa-solid fa-tools" }
    };

    public List<ActionLink> Links { get; set; } = new List<ActionLink> {
        new ActionLink { IconClass = "fa-brands fa-github", Name = "é¡¹ç›®ä¸»é¡µ", Href = "https://github.com/deali-Axy/clipify" },
        new ActionLink { IconClass = "fa-solid fa-house", Name = "CodeLab", Href = "https://deali.cn" },
        new ActionLink { IconClass = "fa-solid fa-blog", Name = "åšå®¢", Href = "http://blog.deali.cn" },
    };

    public List<FeatureCard> Features { get; set; } = new List<FeatureCard> {
        new FeatureCard { IconClass = "fa-solid fa-scissors", Name = "è§†é¢‘åˆ†å‰²", Href = RouterMap.VideoSplit, Desc = "å°†è§†é¢‘åˆ†å‰²æˆå¤šä¸ªç‰‡æ®µ", Category = "basic" },
        new FeatureCard { IconClass = "fa-solid fa-music", Name = "éŸ³é¢‘æå–", Href = RouterMap.ExtractAudio, Desc = "ä»è§†é¢‘ä¸­æå–éŸ³é¢‘", Category = "audio" },
        new FeatureCard { IconClass = "fa-solid fa-hand-scissors", Name = "ç‰‡æ®µè£å‰ª", Desc = "è£å‰ªè§†é¢‘çš„ç‰¹å®šç‰‡æ®µ", Category = "basic" },
        new FeatureCard { IconClass = "fa-solid fa-eraser", Name = "ç‰‡æ®µç§»é™¤", Desc = "ç§»é™¤ä¸éœ€è¦çš„è§†é¢‘ç‰‡æ®µ", Category = "basic" },
        new FeatureCard { IconClass = "fa-regular fa-object-group", Name = "è§†é¢‘åˆå¹¶", Desc = "åˆå¹¶å¤šä¸ªè§†é¢‘ç‰‡æ®µ", Category = "basic" },
        new FeatureCard { IconClass = "fa-regular fa-closed-captioning", Name = "å­—å¹•è¯†åˆ«", Desc = "è¯†åˆ«å¹¶æå–è§†é¢‘ä¸­çš„å­—å¹•", Category = "subtitle" },
        new FeatureCard { IconClass = "fa-solid fa-language", Name = "å­—å¹•ç¿»è¯‘", Desc = "å°†å­—å¹•ç¿»è¯‘æˆå…¶ä»–è¯­è¨€", Category = "subtitle" },
        new FeatureCard { IconClass = "fa-solid fa-sheet-plastic", Name = "æ°´å°æ·»åŠ ", Desc = "ä¸ºè§†é¢‘æ·»åŠ è‡ªå®šä¹‰æ°´å°", Category = "enhance" },
        new FeatureCard { IconClass = "fa-solid fa-download", Name = "è§†é¢‘ä¸‹è½½", Desc = "ä¸‹è½½è§†é¢‘æ–‡ä»¶", Category = "other" },
        new FeatureCard { IconClass = "fa-solid fa-radio", Name = "åšå®¢é‡‡é›†", Desc = "é‡‡é›†æ’­å®¢éŸ³é¢‘", Category = "audio" },
        new FeatureCard { IconClass = "fa-solid fa-sync-alt", Name = "è§†é¢‘æ—‹è½¬", Desc = "æ—‹è½¬è§†é¢‘è§’åº¦", Category = "basic" },
        new FeatureCard { IconClass = "fa-solid fa-tachometer-alt", Name = "è§†é¢‘è°ƒé€Ÿ", Desc = "è°ƒæ•´è§†é¢‘æ’­æ”¾é€Ÿåº¦", Category = "enhance" },
        new FeatureCard { IconClass = "fa-solid fa-crop-alt", Name = "è§†é¢‘è£å‰ª", Desc = "è£å‰ªè§†é¢‘ç”»é¢å°ºå¯¸", Category = "basic" },
        new FeatureCard { IconClass = "fa-solid fa-adjust", Name = "æ»¤é•œåº”ç”¨", Desc = "ä¸ºè§†é¢‘æ·»åŠ è§†è§‰æ»¤é•œ", Category = "enhance" },
        new FeatureCard { IconClass = "fa-solid fa-compress-alt", Name = "è§†é¢‘å‹ç¼©", Desc = "å‹ç¼©è§†é¢‘æ–‡ä»¶å¤§å°", Category = "other" },
        new FeatureCard { IconClass = "fa-solid fa-icons", Name = "èƒŒæ™¯éŸ³ä¹æ·»åŠ ", Desc = "ä¸ºè§†é¢‘æ·»åŠ èƒŒæ™¯éŸ³ä¹", Category = "audio" },
        new FeatureCard { IconClass = "fa-solid fa-expand-arrows-alt", Name = "åˆ†è¾¨ç‡è°ƒæ•´", Desc = "è°ƒæ•´è§†é¢‘åˆ†è¾¨ç‡", Category = "enhance" },
        new FeatureCard { IconClass = "fa-solid fa-palette", Name = "é¢œè‰²æ ¡æ­£", Desc = "è°ƒæ•´è§†é¢‘é¢œè‰²å’Œäº®åº¦", Category = "enhance" },
        new FeatureCard { IconClass = "fa-solid fa-image", Name = "å¸§æå–", Desc = "ä»è§†é¢‘ä¸­æå–ç‰¹å®šå¸§", Category = "other" },
        new FeatureCard { IconClass = "fa-solid fa-play", Name = "è§†é¢‘é¢„è§ˆ", Desc = "é¢„è§ˆè§†é¢‘å†…å®¹", Category = "other" }
    };

    private List<FeatureCard> GetFilteredFeatures()
    {
        if (selectedCategory == "all")
            return Features;
        
        return Features.Where(f => f.Category == selectedCategory).ToList();
    }

    private void SelectCategory(string categoryId)
    {
        selectedCategory = categoryId;
    }

    private async Task FeatureInDev(FeatureCard feature) {
        RenderFragment customIcon = @<i class="@feature.IconClass text-2xl text-blue-500"></i>;
        await NotiService.Open(new NotificationConfig {
            Message = $"{feature.Name} - Clipify Feature",
            Description = $"{feature.Name}åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼",
            Icon = customIcon
        });
    }

    private async Task OpenFileDialog()
    {
        await MsgService.Success("æ–‡ä»¶é€‰æ‹©å™¨ï¼šå³å°†æ‰“å¼€æ–‡ä»¶é€‰æ‹©å™¨ï¼Œè¯·é€‰æ‹©è¦ç¼–è¾‘çš„è§†é¢‘æ–‡ä»¶ã€‚");
        // è¿™é‡Œå®é™…é¡¹ç›®ä¸­åº”è¯¥è°ƒç”¨æ–‡ä»¶é€‰æ‹©å™¨
    }
}